
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>16. 정규분포 &#8212; 데이터로 배우는 통계 분석</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css?v=ca93fcec" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'normal_distribution';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="17. 표본분포" href="sampling_distribution.html" />
    <link rel="prev" title="15. 기댓값과 분산" href="expected_values.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">데이터로 배우는 통계 분석</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="variables_values.html">1. 변수와 값</a></li>
<li class="toctree-l1"><a class="reference internal" href="lists_dicts.html">2. 리스트와 사전</a></li>
<li class="toctree-l1"><a class="reference internal" href="arrays.html">3. 넘파이 어레이</a></li>
<li class="toctree-l1"><a class="reference internal" href="series.html">4. 판다스 시리즈</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataframes.html">5. 판다스 데이터프레임</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_handling.html">6. 데이터 다루기</a></li>
<li class="toctree-l1"><a class="reference internal" href="representatives.html">7. 데이터 대표</a></li>
<li class="toctree-l1"><a class="reference internal" href="oneD_visualization.html">8. 1차원 데이터 시각화</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear_correlation.html">9. 선형 상관관계</a></li>
<li class="toctree-l1"><a class="reference internal" href="twoD_visualization.html">10. 2차원 데이터 시각화</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">11. 모집단과 표본</a></li>
<li class="toctree-l1"><a class="reference internal" href="probability.html">12. 확률분포</a></li>
<li class="toctree-l1"><a class="reference internal" href="probability_discrete.html">13. 이산확률분포</a></li>
<li class="toctree-l1"><a class="reference internal" href="probability_continuous.html">14. 연속확률분포</a></li>
<li class="toctree-l1"><a class="reference internal" href="expected_values.html">15. 기댓값과 분산</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">16. 정규분포</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling_distribution.html">17. 표본분포</a></li>
<li class="toctree-l1"><a class="reference internal" href="hypothesis_testing.html">18. 가설검정</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/codingalzi/statsRev/blob/master/jupyter-book/normal_distribution.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/codingalzi/statsRev" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/codingalzi/statsRev/issues/new?title=Issue%20on%20page%20%2Fnormal_distribution.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/normal_distribution.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>정규분포</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">16.1. 가우스 함수</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">16.1.1. 표준정규분포</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">16.1.2. 정규분포 확률</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">16.1.3. 예제: 피어슨  데이터셋</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">16.2. 정규분포 선형 변환</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">16.3. 정규분포 특징</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">16.4. 정규분포 활용</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">16.4.1. 이항분포확률 계산</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">16.4.2. 연속성 보정</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">16.5. 연습문제</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="ch-normal-distribution">
<span id="id1"></span><h1><span class="section-number">16. </span>정규분포<a class="headerlink" href="#ch-normal-distribution" title="Link to this heading">#</a></h1>
<p><strong>기본 설정</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">numpy</span></code>와 <code class="docutils literal notranslate"><span class="pre">pandas</span></code> 라이브러리를 각각 <code class="docutils literal notranslate"><span class="pre">np</span></code>와 <code class="docutils literal notranslate"><span class="pre">pd</span></code>로 불러온다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<p>데이터프레임의 <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy">chained indexing을 금지시키기 위한 설정</a>을 지정한다.
Pandas 3.0 버전부터는 기본 옵션으로 지정된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">copy_on_write</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<p>주피터 노트북에서 부동소수점의 출력을 소수점 이하 6자리로 제한한다.
아래 코드는 주피터 노트북에서만 사용하며 일반적인 파이썬 코드가 아니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">precision</span> 6
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;%.6f&#39;
</pre></div>
</div>
</div>
</div>
<p>아래 코드는 데이터프레임 내에서 부동소수점의 출력을 소수점 이하 6자리로 제한한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.precision&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>데이터 시각화를 위해 <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code>를 <code class="docutils literal notranslate"><span class="pre">plt</span></code>로,
<code class="docutils literal notranslate"><span class="pre">seaborn</span></code>을 <code class="docutils literal notranslate"><span class="pre">sns</span></code>로 불러온다.
<code class="docutils literal notranslate"><span class="pre">seaborn</span></code> 라이브러리는 통계 관련 데이터의 정보를 보다 세련되고 정확하게 전달하는 그래프를 그리는 도구를 제공한다.
<code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> 라이브러리를 바탕으로 만들어져서 함께 사용해도 된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<p>그래프 스타일을 <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>에서 제공하는 <code class="docutils literal notranslate"><span class="pre">white</span></code> 스타일로 지정한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>데이터 저장소 디렉토리</strong></p>
<p>코드에 사용되는 <a class="reference external" href="https://github.com/codingalzi/statsRev/tree/master/data">데이터 저장소의 기본 디렉토리</a>를 지정한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/codingalzi/statsRev/refs/heads/master/data/&#39;</span>
</pre></div>
</div>
</div>
</div>
<p><strong>주요 내용</strong></p>
<p>확률과 통계에서 가장 유명한 연속확률분포인 정규분포를 소개한다.</p>
<ul class="simple">
<li><p>가우스 함수</p></li>
<li><p>정규분포 표준화</p></li>
<li><p>정규분포 특징</p></li>
<li><p>정규분포 활용</p></li>
</ul>
<section id="id2">
<h2><span class="section-number">16.1. </span>가우스 함수<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p><strong>정규분포</strong><font size='2'>normal distribution</font>는
길이, 크기, 높이 등의 데이터처럼 실생활 또는 자연에서 얻어지는 값을
다룰 때 자주 접하는 확률분포다.
예를 들어 아래 사례들이 일반적으로 정규분포를 따른다.</p>
<ul class="simple">
<li><p>사람들의 키 또는 몸무게의 분포,</p></li>
<li><p>대학생들의 성적 평점의 분포</p></li>
<li><p>초등학생들의 통학시간의 분포</p></li>
</ul>
<p>정규분포의 확률밀도함수는 아래 <strong>가우스 함수</strong><font size='2'>Gaussian function</font>로 정의된다.
단, <span class="math notranslate nohighlight">\(\mu\)</span>는 평균값을, <span class="math notranslate nohighlight">\(\sigma\)</span>는 표준편차를 가리킨다.</p>
<div class="math notranslate nohighlight">
\[
f(x) = \frac{1}{\sigma \sqrt{2\pi}}\, \exp\!\left( \frac{-(x-\mu)^2}{2\sigma^2}\right)
\]</div>
<p>아래 <code class="docutils literal notranslate"><span class="pre">f_gaussian()</span></code> 함수가 가우스 함수를 구현한다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">loc=0</span></code>: 평균값(<span class="math notranslate nohighlight">\(\mu\)</span>). 기본값 0.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scale=1</span></code>: 표준편차(<span class="math notranslate nohighlight">\(\sigma\)</span>). 기본값 1.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_gaussian</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">scale</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">loc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">scale</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>아래 코드는 평균값 <span class="math notranslate nohighlight">\(\mu\)</span>와 표준편차 <span class="math notranslate nohighlight">\(\sigma\)</span>에 따라 가우스 함수의 그래프가
어떻게 달라지는지 보여준다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_gaussian</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mu = 0, \sigma = 1.0$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_gaussian</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mu = 0, \sigma = 0.5$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_gaussian</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">2.0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mu = 0, \sigma = 2.0$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_gaussian</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.8</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mu = 2, \sigma = 0.8$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8617ede209541d915a3d5c725a6533d21fcf0cb0321d55e46e38179d609c6aa8.png" src="_images/8617ede209541d915a3d5c725a6533d21fcf0cb0321d55e46e38179d609c6aa8.png" />
</div>
</div>
<p>확률변수 <span class="math notranslate nohighlight">\(X\)</span>가 평균값이 <span class="math notranslate nohighlight">\(\mu\)</span>이고 분산이 <span class="math notranslate nohighlight">\(\sigma^2\)</span>인
정규분포를 따를 때 아래와 같이 표기한다.</p>
<div class="math notranslate nohighlight">
\[
X \sim N(\mu, \sigma^2)
\]</div>
<p>앞서 직접 구현한 정규분포의 확률밀도함수(pdf) <code class="docutils literal notranslate"><span class="pre">f_gaussian()</span></code> 등 정규분포와
관련된 모든 기능을 <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> 모듈의 <code class="docutils literal notranslate"><span class="pre">norm</span></code> 객체가 제공한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
</pre></div>
</div>
</div>
</div>
<p>예를 들어 <code class="docutils literal notranslate"><span class="pre">norm.pdf()</span></code>가 <code class="docutils literal notranslate"><span class="pre">f_gaussian()</span></code>에 해당하며,
이어지는 코드에서 대신 사용된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_gaussian</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span>
</pre></div>
</div>
</div>
</div>
<p>반면에 <code class="docutils literal notranslate"><span class="pre">norm.cdf()</span></code> 함수는 정규분포의 누적분포함수(cdf)를 가리킨다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F_gaussian</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span>
</pre></div>
</div>
</div>
</div>
<p>두 함수 모두 <code class="docutils literal notranslate"><span class="pre">loc=0</span></code>과 <code class="docutils literal notranslate"><span class="pre">scale=1</span></code>을 키워드 인자로 사용하며
각각 분포의 평균값과 표준편차를 지정한다.</p>
<p><strong>정규분포의 기댓값과 분산</strong></p>
<p>정규분포의 기댓값과 분산은 각각 데이터의 평균값, 분산과 일치한다.
즉 다음이 성립한다.</p>
<div class="math notranslate nohighlight">
\[
X \sim N(\mu, \sigma^2) \quad \Longrightarrow \quad E[X] = \mu,\,\, V(X) = \sigma^2
\]</div>
<section id="id3">
<h3><span class="section-number">16.1.1. </span>표준정규분포<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>표준정규분포는 평균값이 0, 표준편차가 1인 정규분포다.
아래 코드는 표준정규분포의 확률밀도함수만 따로 떼어 그래프로 나타낸다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_gaussian</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mu = 0, \sigma = 1.0$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a860f8260fb2e420c5e5ee90f329fb1f8ae767307302fc73a09fd7f07f01b949.png" src="_images/a860f8260fb2e420c5e5ee90f329fb1f8ae767307302fc73a09fd7f07f01b949.png" />
</div>
</div>
</section>
<section id="id4">
<h3><span class="section-number">16.1.2. </span>정규분포 확률<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>아래 그래프는
<span class="math notranslate nohighlight">\(X \sim N(0, 1)\)</span>일 때, <span class="math notranslate nohighlight">\(X\)</span>가 <span class="math notranslate nohighlight">\(a\)</span>보다 같거나 작은 값을 취할 확률 <span class="math notranslate nohighlight">\(P(X \leq a)\)</span>를
영역으로 보여준다.
즉, <span class="math notranslate nohighlight">\(a\)</span> 보다 같거나 작은 구간에서 확률밀도함수 곡선과 <span class="math notranslate nohighlight">\(x\)</span>-축 사이의 면적이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># norm.pdf()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_gaussian</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># -2에서 1 사이의 면적 표시</span>
<span class="n">point_a</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_gaussian</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">point_a</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="c1"># 함수명 주석 달기</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;f_gaussian&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">.807</span><span class="p">,</span> <span class="n">f_gaussian</span><span class="p">(</span><span class="mf">.8</span><span class="p">)),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">2.3</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">headwidth</span><span class="o">=</span><span class="mi">8</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$P(X \leq a)$&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span> <span class="p">,</span><span class="mf">0.15</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">3.8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">headwidth</span><span class="o">=</span><span class="mi">8</span><span class="p">))</span>

<span class="c1"># point_a를 눈금으로 추가 표시</span>
<span class="n">x_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">(),</span> <span class="n">point_a</span><span class="p">)</span>
<span class="n">x_ticks_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">(),</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="c1"># 실제로 보이는 눈금 기호</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x_ticks</span><span class="p">,</span> <span class="n">x_ticks_</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">)</span> <span class="c1"># a 눈금 색 지정</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.42</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a68b1ec3a688a784cc4a057417c8e5ebdb1222d3a205ce2ed07fde2193d49683.png" src="_images/a68b1ec3a688a784cc4a057417c8e5ebdb1222d3a205ce2ed07fde2193d49683.png" />
</div>
</div>
<p>위 그래프는 <code class="docutils literal notranslate"><span class="pre">a=-0.5</span></code>일 때의 <span class="math notranslate nohighlight">\(P(X \leq a)\)</span>를 보여주며 실제 계산은 <code class="docutils literal notranslate"><span class="pre">F_gaussian()</span></code> 함수를
이용하면 된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F_gaussian</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.308538
</pre></div>
</div>
</div>
</div>
<p>반면에 아래 그래프는
<span class="math notranslate nohighlight">\(X \sim N(0, 1)\)</span>일 때, <span class="math notranslate nohighlight">\(X\)</span>가 <span class="math notranslate nohighlight">\(a\)</span>와 <span class="math notranslate nohighlight">\(b\)</span> 사이의 값을 취할 확률 <span class="math notranslate nohighlight">\(P(a \le X \le b)\)</span>를
구간 <span class="math notranslate nohighlight">\(a\)</span>와 <span class="math notranslate nohighlight">\(b\)</span> 사이에서 확률밀도함수 곡선과 <span class="math notranslate nohighlight">\(x\)</span>-축 사이의 면적으로 보여준다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># norm.pdf()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_gaussian</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># -2에서 1 사이의 면적 표시</span>
<span class="n">point_a</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.5</span>
<span class="n">point_b</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_gaussian</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">point_a</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">point_b</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="c1"># 함수명 주석 달기</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;f_gaussian&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">f_gaussian</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">headwidth</span><span class="o">=</span><span class="mi">8</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$P(a \leq X \leq b)$&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">.8</span> <span class="p">,</span><span class="mf">0.15</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">3.8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">headwidth</span><span class="o">=</span><span class="mi">8</span><span class="p">))</span>

<span class="c1"># point_a와 point_b를 눈금으로 추가 표시</span>
<span class="n">x_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">(),</span> <span class="p">[</span><span class="n">point_a</span><span class="p">,</span> <span class="n">point_b</span><span class="p">])</span>
<span class="n">x_ticks_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">(),</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span> <span class="c1"># 실제로 보이는 눈금 기호</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x_ticks</span><span class="p">,</span> <span class="n">x_ticks_</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">)</span> <span class="c1"># a 눈금 색 지정</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">)</span> <span class="c1"># b 눈금 색 지정</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.42</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2e7f3023826245862b20e5b08c7ef8d4809d00654105a5a92c798405c8eafe13.png" src="_images/2e7f3023826245862b20e5b08c7ef8d4809d00654105a5a92c798405c8eafe13.png" />
</div>
</div>
<p>위 그래프는 <code class="docutils literal notranslate"><span class="pre">a=-1.5</span></code>이고 <code class="docutils literal notranslate"><span class="pre">b=0.5</span></code>일 때의 <span class="math notranslate nohighlight">\(P(a \leq X \leq b)\)</span>를 보여주며 실제 계산은 <code class="docutils literal notranslate"><span class="pre">F_gaussian()</span></code> 함수를
이용한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F_gaussian</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">-</span> <span class="n">F_gaussian</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.624655
</pre></div>
</div>
</div>
</div>
</section>
<section id="id5">
<h3><span class="section-number">16.1.3. </span>예제: 피어슨  데이터셋<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<p>아래 코드는 피어슨<font size='2'>Pearson</font>이 1903년에 실험을 위해 수집한
아버지와 아들의 키로 구성된 데이터셋을 불러온다.
원래 인치 단위를 사용하지만 편의를 위해 센티미터 단위로 변환되었다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pearson</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_url</span><span class="o">+</span><span class="s2">&quot;pearson_dataset.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>처음 다섯 가족의 아버지 키와 아들 키 데이터는 다음과 같다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pearson</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Father</th>
      <th>Son</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>165.1</td>
      <td>151.9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>160.8</td>
      <td>160.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>165.1</td>
      <td>160.8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>167.1</td>
      <td>159.5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>155.2</td>
      <td>163.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>아버지 키와 아들 키 각각 총 1,078개의 부동소수점 값이 포함되었다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pearson</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1078 entries, 0 to 1077
Data columns (total 2 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   Father  1078 non-null   float64
 1   Son     1078 non-null   float64
dtypes: float64(2)
memory usage: 17.0 KB
</pre></div>
</div>
</div>
</div>
<p><strong>밀도 히스토그램 확인</strong></p>
<p>먼저 아들 키의 분포를 확인하기 위해 밀도 히스토그램과
커널 밀도 추정(KDE) 기법으로 찾아진 확률밀도함수의 그래프를 함께 그린다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># 아들 키 밀도 히스토그램</span>
<span class="n">pearson</span><span class="p">[</span><span class="s1">&#39;Son&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># KDE 기법으로 계산된 확률밀도함수 그래프</span>
<span class="n">kde</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">pearson</span><span class="p">[</span><span class="s1">&#39;Son&#39;</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Height&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/91d2b082d04235ac622ed42a9d6bd62ff9a56b844af2c85e6f2d87004225af04.png" src="_images/91d2b082d04235ac622ed42a9d6bd62ff9a56b844af2c85e6f2d87004225af04.png" />
</div>
</div>
<p>그래프를 보면 평균값을 중심으로 거의 좌우 대칭을 이루는 분포를 따른다.
즉, 아들 키가 정규분포를 따르는 것처럼 보인다.
이를 확인하기 위해 먼저 평균값과 분산을 계산한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">desc_son</span> <span class="o">=</span> <span class="n">pearson</span><span class="p">[</span><span class="s1">&#39;Son&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="n">desc_son</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    1078.000000
mean      174.457978
std         7.153552
min       148.600000
25%       169.900000
50%       174.200000
75%       179.100000
max       199.100000
Name: Son, dtype: float64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>아들 키 평균값</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu_son</span> <span class="o">=</span> <span class="n">desc_son</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span>
<span class="n">mu_son</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>174.457978
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>아들 키 표준편차</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sigma_son</span> <span class="o">=</span> <span class="n">desc_son</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span>
<span class="n">sigma_son</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.153552
</pre></div>
</div>
</div>
</div>
<p><strong>정규분포 확인</strong></p>
<p>아래 코드는 <code class="docutils literal notranslate"><span class="pre">mu_son</span></code>과 <code class="docutils literal notranslate"><span class="pre">sigma_son</span></code>을 각각 평균값과 표준편차로 갖는 정규분포의 확률밀도함수 그래프와
앞서 KDE 기법으로 계산된 확률밀도함수 그래프가 거의 동일하게 그려짐을 확인해준다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># 아들 키 데이터에 대해 KDE 기법으로 추정된 확률밀도함수 그래프</span>
<span class="n">kde</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">pearson</span><span class="p">[</span><span class="s1">&#39;Son&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;KDE&#39;</span><span class="p">)</span>

<span class="c1"># mu_son와 sigma_son를 이용한 정규분포의 확률밀도함수 그래프</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">143</span><span class="p">,</span> <span class="mi">204</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="n">f_gaussian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">mu_son</span><span class="p">,</span> <span class="n">sigma_son</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$N(\mu_</span><span class="si">{son}</span><span class="s1">, \sigma_</span><span class="si">{son}</span><span class="s1">^2)$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Height&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9e16eac1885f2ab20e8b0cf4cb712ef982566e1865fa9ce4885b586fee9e7f6f.png" src="_images/9e16eac1885f2ab20e8b0cf4cb712ef982566e1865fa9ce4885b586fee9e7f6f.png" />
</div>
</div>
<p>표준편차가 7.15 정도로 1보다 많이 크기에 정규분포에 비해 보다 펑퍼짐한 봉우리로
그려져야 하지만 표준정규분포에 가깝도록 보인다.
하지만 이는 <span class="math notranslate nohighlight">\(y\)</span>-축이 0에서 0.4가 아닌 0에서 0.06 사이로 설정되었기에
일종의 착시현상임에 주의한다.</p>
<p><strong>정규분포 활용</strong></p>
<p>앞서 확인하였듯이 아들 키를 가리키는 확률변수 <span class="math notranslate nohighlight">\(X\)</span>는
다음과 같이 앞서 계산된 평균값과 표준편차를 갖는 정규분포를 따른다고 간주해도 무방하다.</p>
<div class="math notranslate nohighlight">
\[
X_{son} \sim N(\mu_{son}, \sigma_{son}^2)
\]</div>
<p>따라서 다음과 같이 <code class="docutils literal notranslate"><span class="pre">norm</span></code> 객체를 이용하여 아들 키를 가리키는 확률변수를 선언한다.
<code class="docutils literal notranslate"><span class="pre">norm</span></code> 객체를 활용할 때 함수처럼 평균값과 표준편차를 지정할 수 있음에 주의한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_son</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">mu_son</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma_son</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>평균값과 표준편차가 이미 지정되었기에 확률밀도함수(pdf)와 누적분포함수(cdf) 등은 추가 인자 없이 바로 활용된다.
예를 들어 아래 코드는 임의로 선택된 아들 키가 평균값 이하일 확률이 50%임을 확인해준다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_son</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">mu_son</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.500000
</pre></div>
</div>
</div>
</div>
<p>아래 코드는 우연히 선택된 아들 키가 180 이상일 확률 <span class="math notranslate nohighlight">\(P(X \geq 180)\)</span>를
정규분포의 확률밀도함수의 그래프와 <span class="math notranslate nohighlight">\(x\)</span>-축 사이의 특정 구간의 영역으로 보여준다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">143</span><span class="p">,</span> <span class="mi">204</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">X_son</span><span class="o">.</span><span class="n">pdf</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">180</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$P(X_</span><span class="si">{son}</span><span class="s1"> \geq 180)$&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">184</span> <span class="p">,</span><span class="mf">0.01</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">190</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">headwidth</span><span class="o">=</span><span class="mi">8</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.062</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f2d21ac1555f7ba4094f02b1395a4286b2e850e5a4162b6d42c6c47ddc030bcb.png" src="_images/f2d21ac1555f7ba4094f02b1395a4286b2e850e5a4162b6d42c6c47ddc030bcb.png" />
</div>
</div>
<p>우연히 선택된 아들 키가 180 이상일 확률 <span class="math notranslate nohighlight">\(P(X_{son} \geq 180)\)</span>의 계산은 <code class="docutils literal notranslate"><span class="pre">X_xon.cdf()</span></code> 함수를 이용한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">-</span> <span class="n">X_son</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">180</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.219252
</pre></div>
</div>
</div>
</div>
<p><strong>실제 확률 비교</strong></p>
<p>아래 코드는 데이터셋에서 아들 키가 180 이상인 샘플의 비율을 이용하여
아들 키가 180 이상일 확률을 직접 계산한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 180 이상인 경우만 True</span>
<span class="n">mask_180</span> <span class="o">=</span> <span class="n">pearson</span><span class="p">[</span><span class="s1">&#39;Son&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">180</span>

<span class="c1"># 전체 데이터셋에서 True인 샘플의 비율</span>
<span class="n">mask_180</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">pearson</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.221707
</pre></div>
</div>
</div>
</div>
<p>실제 값과 정규분포의 누적분포함수를 이용하여 계산된 값이 매우 유사하다.
따라서 앞으로는 실제 값을 구하는 대신 정규분포의 성질과 기능만을 활용하여
확률을 계산한다.</p>
<p><strong><span class="math notranslate nohighlight">\(P(180 \leq X_{son} \leq 185)\)</span> 계산</strong></p>
<p>아래 코드는 우연히 선택된 아들 키가 180 이상, 185 이하일 확률 <span class="math notranslate nohighlight">\(P(180 \leq X_{son} \leq 185)\)</span>를 그래프로 보여준다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">143</span><span class="p">,</span> <span class="mi">204</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">X_son</span><span class="o">.</span><span class="n">pdf</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">180</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">185</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$P(180 \leq X_</span><span class="si">{son}</span><span class="s1"> \leq 185)$&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">182.5</span> <span class="p">,</span><span class="mf">0.01</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">188</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">headwidth</span><span class="o">=</span><span class="mi">8</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.062</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4d3f9b2178ce1580527006b9942993d77779df90329a4c588f984d3ba8c31c3e.png" src="_images/4d3f9b2178ce1580527006b9942993d77779df90329a4c588f984d3ba8c31c3e.png" />
</div>
</div>
<p>아들 키를 가리키는 확률변수 <span class="math notranslate nohighlight">\(X_{son}\)</span>이 정규분포 <span class="math notranslate nohighlight">\(N(173.5, (5.17)^2)\)</span> 을 따를 때
키 180 이상, 185 이하의 값을 가리킬 확률 <span class="math notranslate nohighlight">\(P(180 \leq X_{son} \leq 185)\)</span>는 다음과 같이 계산된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_son</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">185</span><span class="p">)</span> <span class="o">-</span> <span class="n">X_son</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">180</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.148967
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id6">
<h2><span class="section-number">16.2. </span>정규분포 선형 변환<a class="headerlink" href="#id6" title="Link to this heading">#</a></h2>
<p>피어슨 데이터셋의 아들 키를 가리키는 확률변수 <span class="math notranslate nohighlight">\(X\)</span>는 다음 정규분포를 따른다.</p>
<div class="math notranslate nohighlight">
\[
X \sim N(\mu_{son}, \sigma_{son}^2)
\]</div>
<p>그런데 키의 단위를 센티미터에서 원래 단위인 인치로 변환하려면 모든 값을 2.54로 나눠야 한다.
그러면 키의 평균값도 2.54배 작아진다.
반면에, 키의 분산은 2.54의 제곱배 작아진다.
즉, 키의 표준편차도 2.54배 작아지며 다음이 성립한다.</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{2.54}X \sim N \left(\frac{\mu_{son}}{2.54}, \left(\frac{\sigma_{son}}{2.54}\right)^2 \right)
\]</div>
<p><span class="math notranslate nohighlight">\(\frac{1}{2.54} X\)</span>는 2.54배 작아진 아들 키를 가리키는 확률변수다.</p>
<p><strong>예제</strong></p>
<p>아들 키 데이터셋을 실제로 변환하여 이론과 동일한 결과가 나오는지 확인한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_son</span> <span class="o">=</span> <span class="n">pearson</span><span class="p">[[</span><span class="s1">&#39;Son&#39;</span><span class="p">]]</span>
<span class="n">data_son</span><span class="p">[</span><span class="s1">&#39;Son(inch)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pearson</span><span class="p">[</span><span class="s1">&#39;Son&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.54</span>
<span class="n">data_son</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Son</th>
      <th>Son(inch)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>151.9</td>
      <td>59.803150</td>
    </tr>
    <tr>
      <th>1</th>
      <td>160.5</td>
      <td>63.188976</td>
    </tr>
    <tr>
      <th>2</th>
      <td>160.8</td>
      <td>63.307087</td>
    </tr>
    <tr>
      <th>3</th>
      <td>159.5</td>
      <td>62.795276</td>
    </tr>
    <tr>
      <th>4</th>
      <td>163.3</td>
      <td>64.291339</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1073</th>
      <td>179.8</td>
      <td>70.787402</td>
    </tr>
    <tr>
      <th>1074</th>
      <td>173.5</td>
      <td>68.307087</td>
    </tr>
    <tr>
      <th>1075</th>
      <td>176.0</td>
      <td>69.291339</td>
    </tr>
    <tr>
      <th>1076</th>
      <td>176.0</td>
      <td>69.291339</td>
    </tr>
    <tr>
      <th>1077</th>
      <td>170.2</td>
      <td>67.007874</td>
    </tr>
  </tbody>
</table>
<p>1078 rows × 2 columns</p>
</div></div></div>
</div>
<p>두 데이터셋의 기초 통계량을 확인하면 평균값과 표준편차 모두 2.54배 작아졌음이 확인된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_son</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Son</th>
      <th>Son(inch)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1078.000000</td>
      <td>1078.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>174.457978</td>
      <td>68.684243</td>
    </tr>
    <tr>
      <th>std</th>
      <td>7.153552</td>
      <td>2.816359</td>
    </tr>
    <tr>
      <th>min</th>
      <td>148.600000</td>
      <td>58.503937</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>169.900000</td>
      <td>66.889764</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>174.200000</td>
      <td>68.582677</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>179.100000</td>
      <td>70.511811</td>
    </tr>
    <tr>
      <th>max</th>
      <td>199.100000</td>
      <td>78.385827</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>평균값 변화</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pearson</span><span class="p">[</span><span class="s1">&#39;Son&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">/</span><span class="mf">2.54</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>68.684243
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>표준편차 변화</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pearson</span><span class="p">[</span><span class="s1">&#39;Son&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">/</span><span class="mf">2.54</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.816359
</pre></div>
</div>
</div>
</div>
<p>확률밀도함수의 그래프를 그려서 정규분포의 선형변환 또한 정규분포를 따름을 보여준다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># 변환된 아들 키 데이터에 대해 KDE 기법으로 추정된 확률밀도함수 그래프</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data_son</span><span class="p">[</span><span class="s1">&#39;Son(inch)&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;KDE (inch)&#39;</span><span class="p">)</span>

<span class="c1"># 변환된 mu_son와 sigma_son를 이용한 정규분포의 확률밀도함수 그래프</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">57</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="n">f_gaussian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">mu_son</span><span class="o">/</span><span class="mf">2.54</span><span class="p">,</span> <span class="n">sigma_son</span><span class="o">/</span><span class="mf">2.54</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$N(\mu_{son(inch)}, \sigma_{son(inch)}^2)$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Height&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/66337be67223182fa3b30e7a7adb5321876fa1f5bf9d05176efd25ca8b645fe9.png" src="_images/66337be67223182fa3b30e7a7adb5321876fa1f5bf9d05176efd25ca8b645fe9.png" />
</div>
</div>
<p><strong>일반화</strong></p>
<p>확률변수 <span class="math notranslate nohighlight">\(X\)</span>가 다음 정규분포를 따른다고 가정한다.</p>
<div class="math notranslate nohighlight">
\[
X \sim N(\mu, \sigma^{2})
\]</div>
<p>데이터셋에 포함된 각각의 값을 <span class="math notranslate nohighlight">\(a\)</span>배한 후 <span class="math notranslate nohighlight">\(b\)</span>를 더해주는 방식으로 선형 변환을 적용하면
변환된 데이터셋의 샘플을 가리키는 확률변수 <span class="math notranslate nohighlight">\(a X + b\)</span>는 다음 정규분포를 따른다.</p>
<div class="math notranslate nohighlight">
\[
aX+b ∼ N\left(a \mu + b, (a \sigma)^2 \right)
\]</div>
<p><strong>정규분포 표준화</strong></p>
<p><a class="reference internal" href="representatives.html#sec-scaling"><span class="std std-numref">7.5절</span></a>에서 데이터 정규화 기법으로 소개된 표준화는
데이터의 분포를 평균값은 0, 표준편차는 1이 되도록 한다.
아래 수식에서 <span class="math notranslate nohighlight">\(\mu_X\)</span>와 <span class="math notranslate nohighlight">\(\sigma_X\)</span>는 각각 <span class="math notranslate nohighlight">\(X\)</span>가 가리키는 값의 평균값과 표준편차를 가리킨다.</p>
<div class="math notranslate nohighlight">
\[
Z = \frac{X-\mu_X}{\sigma_X}
\]</div>
<p>따라서 만약 확률변수 <span class="math notranslate nohighlight">\(X \sim N(\mu, \sigma^2)\)</span>라면
확률변수 <span class="math notranslate nohighlight">\(Z\)</span>는 표준정규분포를 따르게 된다.</p>
<div class="math notranslate nohighlight">
\[
Z \sim N(0,1)
\]</div>
<p><strong>표준화 이전과 이후의 확률</strong></p>
<p>정규분포를 따르는 확률변수를 표준화한 다음에는 평균값과 표준편차만 다를뿐
표준화 이전과 이후의 확률값은 달라지지 않는다.
예를 들어 아들 키 180과 185의 표준 점수는 다음과 같다.</p>
<ul class="simple">
<li><p>180의 표준점수:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z_180</span> <span class="o">=</span> <span class="p">(</span><span class="mi">180</span> <span class="o">-</span> <span class="n">mu_son</span><span class="p">)</span><span class="o">/</span><span class="n">sigma_son</span>
<span class="n">z_180</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.774723
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>185의 표준점수</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z_185</span> <span class="o">=</span> <span class="p">(</span><span class="mi">185</span> <span class="o">-</span> <span class="n">mu_son</span><span class="p">)</span><span class="o">/</span><span class="n">sigma_son</span>
<span class="n">z_185</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.473677
</pre></div>
</div>
</div>
</div>
<p>그러면 아들 키가 180 이상일 확률은 아들 키의 표준 점수가 0.774723 이상일 확률과 동일하다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">X_son</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">180</span><span class="p">))</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">F_gaussian</span><span class="p">(</span><span class="n">z_180</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>반면에 아들 키가 180 이상, 185 이하일 확률은 아들 키의 표준점수가 0.774723 이상, 1.473677 이하일 확률과 동일하다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">X_son</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">185</span><span class="p">)</span> <span class="o">-</span> <span class="n">X_son</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">180</span><span class="p">))</span> <span class="o">==</span> <span class="p">(</span><span class="n">F_gaussian</span><span class="p">(</span><span class="n">z_185</span><span class="p">)</span> <span class="o">-</span> <span class="n">F_gaussian</span><span class="p">(</span><span class="n">z_180</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="id7">
<h2><span class="section-number">16.3. </span>정규분포 특징<a class="headerlink" href="#id7" title="Link to this heading">#</a></h2>
<p>지금까지 살펴 보았듯이
정규분포를 따르는 데이터의 확률밀도함수 그래프는 종 모양의 봉우리 모양을 가지며
아래 특성을 갖는다.</p>
<ul class="simple">
<li><p>그래프의 봉우리가 평균값 <span class="math notranslate nohighlight">\(\mu\)</span> 근처에서 가장 높고 데이터의 분포가 <span class="math notranslate nohighlight">\(\mu\)</span>를 중심으로 좌우 대칭을 이룬다.</p></li>
<li><p>곡선은 <span class="math notranslate nohighlight">\(x\)</span>-축과 절대로 만나지 않으면서 <span class="math notranslate nohighlight">\(\mu\)</span>에서 멀어질 수록 점점 <span class="math notranslate nohighlight">\(x\)</span>-축에 가까워진다.</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma\)</span> 가 커지면 곡선은 넓고 평평해진다.</p></li>
<li><p>곡선과 <span class="math notranslate nohighlight">\(x\)</span>-축 사이의 면적은 항상 1이다.</p></li>
</ul>
<p>그런데 확률밀도함수가 종 모양과 조금 다른 그래프를 그린다 하더라도 정규분포로 인정받는 경우가 있다.
반면에 데이터 분포가 완벽한 대칭을 이루는 종 모양을 갖더라도 정규분포가 아닌 경우도 많다.</p>
<p><strong>정규분포 예제: 아버지 키</strong></p>
<p>피어슨 데이터셋에서 아버지 키의 분포를 확인해보자.
아래 코드는 아버지 키 데이터의 밀도 히스토그램과
KDE 기법으로 추정된 확률밀도함수(pdf0의 그래프를 그린다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># 아들 키 밀도 히스토그램</span>
<span class="n">pearson</span><span class="p">[</span><span class="s1">&#39;Father&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># KDE 기법으로 계산된 확률밀도함수 그래프</span>
<span class="n">kde</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">pearson</span><span class="p">[</span><span class="s1">&#39;Father&#39;</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Height&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ba12bf9429059b91bc4523c6626e5e12b76a4e1567ea9378799829e2c0ec9d2f.png" src="_images/ba12bf9429059b91bc4523c6626e5e12b76a4e1567ea9378799829e2c0ec9d2f.png" />
</div>
</div>
<p>밀도 히스토그램과 확률밀도함수 모두 정규분포와 거리가 있어 보인다.
이번엔 아버지 키의 평균값과 표준편차를 갖는 정규분포의 확률밀도함수 그래프와
KDE 기법으로 추정된 확률밀도함수의 그래프를 함께 그려보자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 아버지 키의 평균값과 표준편차</span>
<span class="n">mu_father</span> <span class="o">=</span> <span class="n">pearson</span><span class="p">[</span><span class="s1">&#39;Father&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">sigma_father</span> <span class="o">=</span> <span class="n">pearson</span><span class="p">[</span><span class="s1">&#39;Father&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># mu_father와 sigma_father를 이용한 정규분포의 확률밀도함수 그래프</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">143</span><span class="p">,</span> <span class="mi">204</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="n">f_gaussian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">mu_father</span><span class="p">,</span> <span class="n">sigma_father</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$N(\mu_</span><span class="si">{father}</span><span class="s1">, \sigma_</span><span class="si">{father}</span><span class="s1">^2)$&#39;</span><span class="p">)</span>

<span class="c1"># 아버지 키 데이터에 대해 KDE 기법으로 추정된 확률밀도함수 그래프</span>
<span class="n">kde</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">pearson</span><span class="p">[</span><span class="s1">&#39;Father&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;KDE&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Height&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/92974956b6b13d258606bcab432bba60dda208403a133357dd68260046510cbe.png" src="_images/92974956b6b13d258606bcab432bba60dda208403a133357dd68260046510cbe.png" />
</div>
</div>
<p>두 함수의 그래프가 서로 조금 다르기는 하지만 평균값을 중심으로 좌우로 퍼져있는 정도와
대칭성이 거의 일치한다. 따라서 아버지 키 데이터 또한 정규분포를 따른다고 말할 수 있다.</p>
<p><strong>정규분포가 아닌 예제: t-분포</strong></p>
<p>t-분포는 정규분포를 따르는 모집단의 평균값이 위치하는 구간을 추정할 때 사용되는 분포이며,
자유도에 따라 데이터 분포가 달라진다.
t-분포에 대해서는 나중에 자세히 다룰 것이며 여기서는 정규분포와 유사하지만
정규분포는 아닌 하나의 예제로만 활용한다.</p>
<p>먼저 자유도(<span class="math notranslate nohighlight">\(\nu\)</span>)가 3인 t-분포 <span class="math notranslate nohighlight">\(t_\nu\)</span>를 가리키는 변수 <code class="docutils literal notranslate"><span class="pre">t_nu</span></code>를 선언한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">t</span>

<span class="n">nu</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">t_nu</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="n">nu</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>아래 코드는 <span class="math notranslate nohighlight">\(t_\nu\)</span>-분포의 확률밀도함수 그래프를 그린다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t_nu</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.01</span><span class="p">),</span> <span class="n">t_nu</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.99</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t_nu</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$t_\nu$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/55039a87531493b8595503b80bab50d8c92c0c10d91ddf73cfe3b05cfbcde6e9.png" src="_images/55039a87531493b8595503b80bab50d8c92c0c10d91ddf73cfe3b05cfbcde6e9.png" />
</div>
</div>
<div class="note admonition">
<p class="admonition-title">확률분포의 <code class="docutils literal notranslate"><span class="pre">ppf()</span></code> 메서드</p>
<p>위 코드에 사용된 분포 객체의 <code class="docutils literal notranslate"><span class="pre">ppf()</span></code> 메서드는
백분위수 함수<font size='2'>percent point function</font>이며,
누적분포함수(cdf)의 역함수에 해당한다.
즉, 다음이 성립한다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">p</span> <span class="o">&lt;=&gt;</span> <span class="n">ppf</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span>
</pre></div>
</div>
<p>예를 들어 <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">t_nu.ppf(0.01)</span></code>는
자유도가 3인 t-분포를 따르는 확률변수 <code class="docutils literal notranslate"><span class="pre">t_nu</span></code>가 <code class="docutils literal notranslate"><span class="pre">x</span></code> 보다 작은 값을 가질 확률이 1%라는 의미다.
따라서 <code class="docutils literal notranslate"><span class="pre">t_nu</span></code>의 확률밀도함수는 <code class="docutils literal notranslate"><span class="pre">x</span></code>에서 0에 매우 가까운 함숫값을 갖는다.
동일한 방식으로 <code class="docutils literal notranslate"><span class="pre">t_nu.ppf(0.99)</span></code>가 가리키는 값이 평균값을 기준으로 <code class="docutils literal notranslate"><span class="pre">t_nu.ppf(0.01)</span></code>에
대칭되는 값을 가리킴을 쉽게 이해할 수 있다.</p>
<p>이런 두 함숫값의 성질을 이용하여 위 코드에서 두 값을 <span class="math notranslate nohighlight">\(x\)</span>-축의 범위로 지정하였다.</p>
</div>
<p><span class="math notranslate nohighlight">\(t_\nu\)</span>-분포의 확률밀도함수 그래프만 보면 정규분포처럼 보인다.
이를 확인하기 위해 위 그래프를
<span class="math notranslate nohighlight">\(t_\nu\)</span>-분포와 동일한 평균값과 표준편차를 갖는 정규분포의 확률밀도함수 그래프와
함께 그려보자.</p>
<p>다음 <code class="docutils literal notranslate"><span class="pre">X_normal</span></code> 변수는
<span class="math notranslate nohighlight">\(t_\nu\)</span>-분포와 동일한 평균값과 표준편차를 갖는 정규분포를 따르는 확률변수를 가리킨다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu_nu</span> <span class="o">=</span> <span class="n">t_nu</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">sigma_nu</span> <span class="o">=</span> <span class="n">t_nu</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">X_normal</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">mu_nu</span><span class="p">,</span> <span class="n">sigma_nu</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>아래 코드는 두 분포의 확률밀도함수 그래프가 매우 다르게 그려짐을 확인해준다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t_nu</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.01</span><span class="p">),</span> <span class="n">t_nu</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.99</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t_nu</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$t_\nu$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">X_normal</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$N(\mu_\nu, \sigma_\nu)$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a3acac0dde3d9f1e9186b282d341e38b6dd7f0540722cdab558575db6e5f154c.png" src="_images/a3acac0dde3d9f1e9186b282d341e38b6dd7f0540722cdab558575db6e5f154c.png" />
</div>
</div>
<p><strong>정규분포와 표준편차</strong></p>
<p>정균분포를 특징짓는 성질이 하나 더 있으며 바로 표준편차와 관련된 확률값이다.
임의의 정규분포 <span class="math notranslate nohighlight">\(X \sim N(\mu, \sigma)\)</span>에 대해
평균값을 기준으로 좌우 <span class="math notranslate nohighlight">\(\sigma\)</span>, <span class="math notranslate nohighlight">\(2\sigma\)</span>, <span class="math notranslate nohighlight">\(3\sigma\)</span>와 관련된 확률값이
아래 그래프에 표시된 대로 계산된다.</p>
<p><div align="center"><img src="https://raw.githubusercontent.com/codingalzi/statsRev/master/jupyter-book/images/standard_deviation_diagram.png" style="width:700px"></div></p><p>표준정규분포를 대상으로 실제로 확률값을 계산해보자.
여기서는 편의상 표준정규분포를 이용하지만 임의의 정규분포에 대해서 확률값은 동일하다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>평균값 <span class="math notranslate nohighlight">\(\mu\)</span>부터 <span class="math notranslate nohighlight">\(\sigma\)</span>까지의 영역의 크기</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F_gaussian</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">-</span> <span class="n">F_gaussian</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.341345
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>평균값 <span class="math notranslate nohighlight">\(\mu\)</span>를 중심으로 좌우 <span class="math notranslate nohighlight">\(\sigma\)</span> 만틈 떨어진 영역의 크기</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F_gaussian</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">-</span> <span class="n">F_gaussian</span><span class="p">(</span><span class="o">-</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.682689
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>평균값 <span class="math notranslate nohighlight">\(\mu\)</span>부터 <span class="math notranslate nohighlight">\(2\sigma\)</span>까지의 영역의 크기</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F_gaussian</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">-</span> <span class="n">F_gaussian</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.477250
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>평균값 <span class="math notranslate nohighlight">\(\mu\)</span>를 중심으로 좌우 <span class="math notranslate nohighlight">\(2\sigma\)</span> 만틈 떨어진 영역의 크기</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F_gaussian</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">-</span> <span class="n">F_gaussian</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.954500
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>평균값 <span class="math notranslate nohighlight">\(\mu\)</span>부터 <span class="math notranslate nohighlight">\(3\sigma\)</span>까지의 영역의 크기</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F_gaussian</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">-</span> <span class="n">F_gaussian</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.498650
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>평균값 <span class="math notranslate nohighlight">\(\mu\)</span>를 중심으로 좌우 <span class="math notranslate nohighlight">\(3\sigma\)</span> 만틈 떨어진 영역의 크기</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F_gaussian</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">-</span> <span class="n">F_gaussian</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.997300
</pre></div>
</div>
</div>
</div>
<p><strong><span class="math notranslate nohighlight">\(t\)</span>-분포의 확률값</strong></p>
<p>반면에 자유도가 3인 <span class="math notranslate nohighlight">\(t\)</span>-분포에 대해서는 각 구간에 대해 다른 확률값이
구간별로 정규분포에 비해 많이 작게 계산된다.</p>
<ul class="simple">
<li><p>평균값 <span class="math notranslate nohighlight">\(\mu\)</span>를 중심으로 좌우 <span class="math notranslate nohighlight">\(\sigma\)</span> 만틈 떨어진 영역의 크기: 정규분포의 경우는 0.682689</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_nu</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">sigma</span><span class="p">)</span> <span class="o">-</span> <span class="n">t_nu</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="n">sigma</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.608998
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>평균값 <span class="math notranslate nohighlight">\(\mu\)</span>를 중심으로 좌우 <span class="math notranslate nohighlight">\(2\sigma\)</span> 만틈 떨어진 영역의 크기: 정규분포의 경우는 0.954500</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_nu</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sigma</span><span class="p">)</span> <span class="o">-</span> <span class="n">t_nu</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">sigma</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.860674
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>평균값 <span class="math notranslate nohighlight">\(\mu\)</span>를 중심으로 좌우 <span class="math notranslate nohighlight">\(3\sigma\)</span> 만틈 떨어진 영역의 크기: 정규분포의 경우는 0.997300</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_nu</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">)</span> <span class="o">-</span> <span class="n">t_nu</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.942331
</pre></div>
</div>
</div>
</div>
</section>
<section id="id8">
<h2><span class="section-number">16.4. </span>정규분포 활용<a class="headerlink" href="#id8" title="Link to this heading">#</a></h2>
<section id="id9">
<h3><span class="section-number">16.4.1. </span>이항분포확률 계산<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<p>동일한 시도를 <span class="math notranslate nohighlight">\(n\)</span>번 반복할 때, 매 시도에서 <span class="math notranslate nohighlight">\(p\)</span>의 확률로 발생하는 사건이 발생하는 빈도를 가리키는 확률변수가
따르는 분포를 <strong>이항분포</strong>라 한다.
단, 각각의 시도는 상호 독립적이어야 한다.</p>
<p>이항분포를 따르는 확률변수 <span class="math notranslate nohighlight">\(X\)</span>를 다음과 같이 표기한다.</p>
<div class="math notranslate nohighlight">
\[
X ∼ B(n,p)
\]</div>
<p>확률변수가 위 이항분포를 따를 때 해당 사건이 <span class="math notranslate nohighlight">\(k\)</span>번 발생할 확률은 다음과 같이 계산된다.</p>
<div class="math notranslate nohighlight">
\[
P(X = k) = \binom{n}{k}\, p^k\, (1-p)^{n-k}
\]</div>
<p>위 식에서 <span class="math notranslate nohighlight">\(\binom{n}{k}\)</span>는 서로 다른 <span class="math notranslate nohighlight">\(n\)</span>개 중에서 <span class="math notranslate nohighlight">\(k\)</span>개를 선택하는 경우의 수를 가리킨다.</p>
<div class="math notranslate nohighlight">
\[
\binom n k = \frac{n!}{k!\, (n-k)!}
\]</div>
<p><strong>예제: 5지선다 40문제를 임의로 찍어서 30 문제 이상 맞힐 확률</strong></p>
<p>5지선다 문제 하나를 임의로 답을 찍어 맞힐 확률은 1/5, 즉 0.2다.
40문제 각각에 대해 임의로 답을 찍는 행위는 서로 독립적이기에
40문제 중에서 맞히는 답의 수는 다음 이항분포를 따른다.</p>
<div class="math notranslate nohighlight">
\[
X_{bin} \sim B\left (40, 0.2\right )
\]</div>
<p>따라서 40문제 중 15문제 이상 맞힐 확률은 아래와 같이 계산된다.</p>
<div class="math notranslate nohighlight">
\[
\sum_{k=15}^{40} \binom{40}{k}\,\left (\frac{1}{5}\right )^{k}\,\left (\frac{4}{5}\right )^{40-k} =
\binom{40}{15}\,\left (\frac{1}{5}\right )^{15}\,\left (\frac{4}{5}\right )^{25}
+ \cdots
+ \binom{40}{40}\,\left (\frac{1}{5}\right )^{40}\,\left (\frac{4}{5}\right )^{0}
\]</div>
<p>그런데 위 계산은 너무 수고스럽거나, 너무 오래 걸리거나, 경우에 따라 계산이 불가능하다.
이유는 <span class="math notranslate nohighlight">\(n!\)</span> 등의 계산이 <span class="math notranslate nohighlight">\(n\)</span>이 조금만 커져도 너무 오래 걸리거나 심지어 웬만한 PC로도
불가능해지기 때문이다.</p>
<p>이런 경우 정규분포를 활용할 수 있다.
단, 다음 조건이 성립해야 한다.</p>
<div class="math notranslate nohighlight">
\[
X_{bin} \sim B(n, p), \quad n p&gt;5, \quad n (1-p)&gt;5
\]</div>
<p>그러면 확률변수 <span class="math notranslate nohighlight">\(X_{bin}\)</span>는 평균값은 <span class="math notranslate nohighlight">\(n p\)</span>, 분산은 <span class="math notranslate nohighlight">\(n p (1-p)\)</span>인 정규분포를 따른다고 간주해도 된다.
즉 다음이 성립한다.</p>
<div class="math notranslate nohighlight">
\[
X_{bin} \sim N(n p, n p (1-p))
\]</div>
<p>그리고
<span class="math notranslate nohighlight">\(40 \cdot 0.2 = 8\)</span>, <span class="math notranslate nohighlight">\(40 \cdot 0.8 = 32\)</span> 이기에 확률변수 <span class="math notranslate nohighlight">\(X\)</span>가 <span class="math notranslate nohighlight">\(N(8, 6.4)\)</span>의 정규분포를 따른다고 말할 수 있다.
아래 코드의 <code class="docutils literal notranslate"><span class="pre">X_contiuous</span></code> 변수가 위 정규분포를 따르는 연속확률변수 <span class="math notranslate nohighlight">\(X_{bin}\)</span>를 가리킨다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_continuous</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">6.4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>이제 40문제중 15문제 이상을 맞힐 확률 <span class="math notranslate nohighlight">\(P(X_{bin} \geq 15)\)</span>은 다음과 같이 쉽게 계산된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">-</span> <span class="n">X_continuous</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.002829
</pre></div>
</div>
</div>
</div>
<p>반면에 7 문제 이하로 맞힐 확률은 다음과 같다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_continuous</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.346316
</pre></div>
</div>
</div>
</div>
<p>그런데 위 결과들이 정확하지 않다.
실제로 이항분포의 누적분포함수를 이용하여 계산하면 많이 다른 확률값이 계산된다.
이를 위해 <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> 모듈의 <code class="docutils literal notranslate"><span class="pre">binom</span></code> 객체를 활용한다.
아래 코드의 <code class="docutils literal notranslate"><span class="pre">X_discrete</span></code> 변수가 5지선다 40문제를 임의로 찍었을 때 맞히는 문제의 개수를 가리키는 확률변수를 선언한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">binom</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.2</span>

<span class="n">X_discrete</span> <span class="o">=</span> <span class="n">binom</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>이산일 때의 <span class="math notranslate nohighlight">\(P(X_{bin} \geq 15)\)</span>는 다음과 같다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">-</span> <span class="n">X_discrete</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.007916
</pre></div>
</div>
</div>
</div>
<p>반면에 이산일 때의 <span class="math notranslate nohighlight">\(P(X_{bin} \leq 7)\)</span>는 다음과 같다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_discrete</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.437146
</pre></div>
</div>
</div>
</div>
<p>이렇게 오차가 크게 발생하는 이유는 이산확률변수를 연속확률변수로 간주할 때 항상 발생하며
이런 오차를 보정해야만 보다 정확한 확률값을 계산할 수 있다.
이산에서 연속으로 변환할 때 발생하는 오차를 보정하는 기법을
연속성 보정이라 한다.
이어서 보다 단순한 이항분포를 이용하여 자세히 설명한다.</p>
</section>
<section id="id10">
<h3><span class="section-number">16.4.2. </span>연속성 보정<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<p>이항분포를 정규분포로 대체하여 확률을 계산할 때 주의할 점이 하나 있다.
설명을 위해 정상적인 동전을 반복해서 12번 던졌을 때 앞면이 5번 이하로 나올 확률을 계산해보자.</p>
<p>정상적인 동전을 던졌을 때 앞면이 나올 확률은 0.5이며,
동전을 던질 때마다의 결과는 이전 결과와 아무 상관이 없다.
즉, 12번의 동전던지기가 상호 독립적이며, 따라서
동전을 12번 던져서 앞면이 나오는 횟수를 가리키는 확률변수 <span class="math notranslate nohighlight">\(X\)</span>는 다음 이항분포를 따른다.</p>
<div class="math notranslate nohighlight">
\[
X \sim B(12, 0.5)
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">binom</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">X_12</span> <span class="o">=</span> <span class="n">binom</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>예제: 정상적인 동전을 12번 던져서 앞면이 5번 이하 나올 확률</strong></p>
<p><span class="math notranslate nohighlight">\(X \sim B(12, 0.5)\)</span>가 성립하기에 <span class="math notranslate nohighlight">\(P(X \leq 5)\)</span>는 다음과 같이 계산된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P_less5</span> <span class="o">=</span> <span class="n">X_12</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">P_less5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.387207
</pre></div>
</div>
</div>
</div>
<p>반면에, <span class="math notranslate nohighlight">\(12 \cdot 0.5 = 6 &gt; 5\)</span>가 성립하여, <span class="math notranslate nohighlight">\(P(X \le 5)\)</span>를 계산하기 위해
<span class="math notranslate nohighlight">\(X \sim N(6,3)\)</span>을 활용할 수 있다.
그런데 정규분포를 이용한 계산이 기대와는 다른 결과를 보여준다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F_gaussian</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.281851
</pre></div>
</div>
</div>
</div>
<p>앞서 정규분포를 사용하여 이항분포의 확률을 계산해도 된다고 하였는데,
전혀 비슷하지 않은 결과가 나왔다.
원인을 찾기 위해 먼저 막대그래프를 이용한다.</p>
<p>이산확률변수로서의 <span class="math notranslate nohighlight">\(X\)</span>가 <span class="math notranslate nohighlight">\(X \sim B(12, 0.5)\)</span>일 때
<span class="math notranslate nohighlight">\(P(X \leq 5)\)</span>은 아래 그래프에서 빨강색으로 칠해진 막대들의 면적에 해당한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 이항분포 확률질량함수 그래프</span>
<span class="n">x1</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="n">bar_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tab:red&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">7</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">X_12</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">bar_colors</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.8</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f0b557ebd0b8260e039ce5e118bb084ad9d5bc6caf2504baa5057fc3ec3d9170.png" src="_images/f0b557ebd0b8260e039ce5e118bb084ad9d5bc6caf2504baa5057fc3ec3d9170.png" />
</div>
</div>
<p>반면에 아래 코드는 <span class="math notranslate nohighlight">\(X\)</span>가 정규분포 <span class="math notranslate nohighlight">\(N(6, 3)\)</span>을 따른다고 가정했을 때의 확률밀도함수 그래프를 함께 그린다.
옅은 검정색으로 칠해진 영역은 연속확률변수로서의 <span class="math notranslate nohighlight">\(P(X \leq 5)\)</span>에 해당한다.</p>
<p>그런데 이산일 때의 <span class="math notranslate nohighlight">\(P(X \leq 5)\)</span>가 연속일 때의 <span class="math notranslate nohighlight">\(P(X \leq 5)\)</span>보다 화살표로 표시된 영역만큼 더 크다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 이항분포 확률질량함수 그래프</span>
<span class="n">x1</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="n">bar_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tab:red&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">7</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">X_12</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">bar_colors</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.8</span><span class="p">)</span>

<span class="c1"># 정규분포 확률밀도함수 그래프</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">f_gaussian</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">f_gaussian</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span> <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">x2</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Extra area&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">5.27</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.9</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">),</span> 
            <span class="n">arrowprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;headwidth&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>

<span class="c1"># ax.hlines(0.23, 5.5, 6, color=&#39;gray&#39;, linestyle=&#39;solid&#39;, linewidth=3)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$N(6, 3)$&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">8.</span><span class="p">,</span> <span class="n">f_gaussian</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">+</span><span class="mf">.01</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">),</span> 
            <span class="n">arrowprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;headwidth&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9d78144d66c7be86191fac5b42021e27921e6691acd278ee32cbfa5dc1ca8b93.png" src="_images/9d78144d66c7be86191fac5b42021e27921e6691acd278ee32cbfa5dc1ca8b93.png" />
</div>
</div>
<p>앞서 설명에 따라 이산확률분포에 대한 확률을 연속확률분포를 이용하여 계산하고자 할 때
발생하는 차이를 보정해주는 과정이 필요하며
이를 <strong>연속성 보정</strong><font size='2'>continuity correction</font>이라 부른다.</p>
<p>앞에 언급한 예제의 경우, 정규분포의 확률밀도함수 그래프에 따르면
<span class="math notranslate nohighlight">\(P(X \leq 5)\)</span> 대신에 <span class="math notranslate nohighlight">\(P(X \leq 5.5)\)</span>이 이산확률변수로서의 <span class="math notranslate nohighlight">\(P(X \leq 5)\)</span>에 해당한다는 것을 알 수 있다.</p>
<p>실제로 <span class="math notranslate nohighlight">\(X \sim N(6,3)\)</span>일 때 다음과 같이 확률값이 계산된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F_gaussian</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.386415
</pre></div>
</div>
</div>
</div>
<p>이산일 때의 <span class="math notranslate nohighlight">\(P(X \leq 5)\)</span>는 다음과 같았다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P_less5</span> <span class="o">=</span> <span class="n">X_12</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">P_less5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.387207
</pre></div>
</div>
</div>
</div>
<p><strong>예제: 정상적인 동전을 12번 던져서 앞면이 9번 이상 나올 확률</strong></p>
<p>이산일 때의 <span class="math notranslate nohighlight">\(P(X \geq 9)\)</span>는 다음과 같다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P_above9</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span> <span class="n">X_12</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="n">P_above9</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.072998
</pre></div>
</div>
</div>
</div>
<p>연속일 때의 <span class="math notranslate nohighlight">\(P(X \geq 9)\)</span>는 다음과 같으며 이산일 때보다 작게 계산된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">-</span> <span class="n">F_gaussian</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.041632
</pre></div>
</div>
</div>
</div>
<p>이번에도 그래프를 그려보면 연속일 때의 확률이 작게 계산되는 이유가 이전 예제에서와 유사한 방식으로 설명될 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 이항분포 확률질량함수 그래프</span>
<span class="n">x1</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="n">bar_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">9</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;tab:red&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">X_12</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">bar_colors</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.8</span><span class="p">)</span>

<span class="c1"># 정규분포 확률밀도함수 그래프</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">f_gaussian</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">f_gaussian</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span> <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">x2</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Extra area&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">8.8</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">9.1</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">),</span> 
            <span class="n">arrowprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;headwidth&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>

<span class="c1"># ax.hlines(0.23, 5.5, 6, color=&#39;gray&#39;, linestyle=&#39;solid&#39;, linewidth=3)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$N(6, 3)$&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">8.</span><span class="p">,</span> <span class="n">f_gaussian</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">+</span><span class="mf">.01</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">),</span> 
            <span class="n">arrowprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;headwidth&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7a8b3e6152f5f48c4b38ee623351d40635cc64ac41be7d3c5039fa00751f4d26.png" src="_images/7a8b3e6152f5f48c4b38ee623351d40635cc64ac41be7d3c5039fa00751f4d26.png" />
</div>
</div>
<p>따라서 이번에도 연속성 보정을 적용하여
연속일 때의 확률값은 <span class="math notranslate nohighlight">\(P(X \geq 8.5)\)</span>로 계산해야
이산일 때의 <span class="math notranslate nohighlight">\(P(X \geq 9)\)</span>에 근사한 확률값을 얻는다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">-</span> <span class="n">F_gaussian</span><span class="p">(</span><span class="mf">8.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.074457
</pre></div>
</div>
</div>
</div>
<p><strong>예제: 정상적인 동전을 12번 던져서 앞면이 3번 이상 6번 이하 나올 확률</strong></p>
<p>이산일 때의 <span class="math notranslate nohighlight">\(P(3 \leq X \leq 6)\)</span>는 다음과 같다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P_3between6</span> <span class="o">=</span> <span class="n">X_12</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">X_12</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">P_3between6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.593506
</pre></div>
</div>
</div>
</div>
<p>연속일 때의 <span class="math notranslate nohighlight">\(P(3 \leq X \leq 6)\)</span>는 다음과 같으며 이산일 때보다 작게 계산된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F_gaussian</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">-</span> <span class="n">F_gaussian</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.458368
</pre></div>
</div>
</div>
</div>
<p>이번에도 그래프를 그려보면 연속일 때의 확률이 작게 계산되는 이유가 이전 예제에서와 유사한 방식으로 설명될 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 이항분포 확률질량함수 그래프</span>
<span class="n">x1</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="n">bar_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;tab:red&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">X_12</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">bar_colors</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.8</span><span class="p">)</span>

<span class="c1"># 정규분포 확률밀도함수 그래프</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">f_gaussian</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">f_gaussian</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span> <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">x2</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x2</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Extra area&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">2.75</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">),</span> 
            <span class="n">arrowprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;headwidth&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Extra area&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">6.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">7.8</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">),</span> 
            <span class="n">arrowprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;headwidth&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>

<span class="c1"># ax.hlines(0.23, 5.5, 6, color=&#39;gray&#39;, linestyle=&#39;solid&#39;, linewidth=3)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$N(6, 3)$&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">8.</span><span class="p">,</span> <span class="n">f_gaussian</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">+</span><span class="mf">.01</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">),</span> 
            <span class="n">arrowprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;headwidth&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/595a1b67c8a849192fbdd28891ac9d0d842d7513a06a05ddeedfd03369cf1d03.png" src="_images/595a1b67c8a849192fbdd28891ac9d0d842d7513a06a05ddeedfd03369cf1d03.png" />
</div>
</div>
<p>따라서 이번에도 연속성 보정을 적용하여
연속일 때의 확률값은 <span class="math notranslate nohighlight">\(P(2.5 \leq X \leq 6.5)\)</span>로 계산해야
이산일 때의 <span class="math notranslate nohighlight">\(P(3 \leq X \leq 6)\)</span>에 근사한 확률값을 얻는다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F_gaussian</span><span class="p">(</span><span class="mf">6.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">-</span> <span class="n">F_gaussian</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.591931
</pre></div>
</div>
</div>
</div>
<p><strong>이항분포 연속성 보정 일반화</strong></p>
<p>이산확률변수 <span class="math notranslate nohighlight">\(X\)</span>가 이항분포를 따르며 다음이 성립한다고 가정한다.</p>
<div class="math notranslate nohighlight">
\[
X \sim B(n,p), \quad np&gt;5,\quad n(1-p)&gt;5
\]</div>
<p>그러면 확률변수 <span class="math notranslate nohighlight">\(X\)</span>를 다음 정규분포를 따르는 연속확률변수로 간주해도 된다.</p>
<div class="math notranslate nohighlight">
\[
X \sim N(np, npq)
\]</div>
<p>하지만 정규분포를 따르는 연속확률변수로 간주했을 때 경우에 따라 연속성 보정을 다음과 같이
적용해야 한다.</p>
<div class="pst-scrollable-table-container"><table class="table" id="continuity-correction">
<caption><span class="caption-number">Table 16.1 </span><span class="caption-text">연속성 보정</span><a class="headerlink" href="#continuity-correction" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>이항분포 (이산)</p></th>
<th class="head"><p>정규분포 (연속)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(P(X \leq a)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(P(X \leq a+0.5)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(P(X \geq a)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(P(X \geq a-0.5)\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(P(a \leq X \leq b)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(P(a-0.5 \leq X \leq b+0.5)\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>이항분포 연속성 보정 예제: 5지선다 40문제를 임의로 찍어서 30 문제 이상 맞힐 확률</strong></p>
<p>5지선다 40문제의 답을 모두 임의로 찍어 15문제 이상을 맞힐 확률을 연속성 보정을 적용하여 다시 계산한다.</p>
<p>5지선다 문제 하나를 임의로 답을 찍어 맞힐 확률은 1/5, 즉 0.2다.
40문제 각각에 대해 임의로 답을 찍는 행위는 서로 독립적이기에
40문제 중에서 맞히는 답의 수는 다음 이항분포를 따른다.</p>
<div class="math notranslate nohighlight">
\[
X_{bin} \sim B\left (40, 0.2\right )
\]</div>
<p>아래 <code class="docutils literal notranslate"><span class="pre">X_discrete</span></code> 변수가 이산확률변수로서의 <span class="math notranslate nohighlight">\(X_{bin}\)</span>을 가리킨다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">binom</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.2</span>

<span class="n">X_discrete</span> <span class="o">=</span> <span class="n">binom</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>또한 다음이 성립한다.</p>
<div class="math notranslate nohighlight">
\[
40 \cdot 0.2 = 8 &gt;5, \quad 40 \cdot 0.8 = 32&gt;5
\]</div>
<p>따라서 확률변수 <span class="math notranslate nohighlight">\(X_{bin}\)</span>를 다음 정규분포를 따르는 연속확률변수로 간주할 수 있다.</p>
<div class="math notranslate nohighlight">
\[
X_{bin} \sim N(8, 6.4)
\]</div>
<p>아래 <code class="docutils literal notranslate"><span class="pre">X_coninuous</span></code> 변수가 연속확률변수로서의 <span class="math notranslate nohighlight">\(X_{bin}\)</span>을 가리킨다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_continuous</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">6.4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>이산일 때의 <span class="math notranslate nohighlight">\(P(X_{bin} \geq 15)\)</span>는 다음과 같다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">-</span> <span class="n">X_discrete</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.007916
</pre></div>
</div>
</div>
</div>
<p>연속일 때는 연속성 보정을 적용하여 <span class="math notranslate nohighlight">\(P(X_{bin} \geq 14.5)\)</span>를 계산한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">-</span> <span class="n">X_continuous</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mf">14.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.005094
</pre></div>
</div>
</div>
</div>
<p>연속성 보정을 적용하지 않고 <span class="math notranslate nohighlight">\(P(X_{bin} \geq 15)\)</span>를 계산하면 오차가 더 커진다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">-</span> <span class="n">X_continuous</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.002829
</pre></div>
</div>
</div>
</div>
<p>반면에 이산일 때의 <span class="math notranslate nohighlight">\(P(X_{bin} \leq 7)\)</span>는 다음과 같다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_discrete</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.437146
</pre></div>
</div>
</div>
</div>
<p>연속일 때는 연속성 보정을 적용하여 <span class="math notranslate nohighlight">\(P(X_{bin} \leq 7.5)\)</span>를 계산한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_continuous</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mf">7.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.421662
</pre></div>
</div>
</div>
</div>
<p>연속성 보정을 적용하지 않고 <span class="math notranslate nohighlight">\(P(X_{bin} \leq 7)\)</span>을 계산하면 역시나 오차가 더 커진다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_continuous</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.346316
</pre></div>
</div>
</div>
</div>
<div class="note admonition">
<p class="admonition-title">연속성 보정 주의사항</p>
<p>연속확률분포를 따르는 것으로 간주되는 실전 데이터를 다룰 때에 항상 연속성 보정을 진행해야 한다.
이항분포의 확률을 정규분포를 이용하여 계산하는 경우뿐만 아니라
<a class="reference internal" href="probability_continuous.html#sec-continuity-correction"><span class="std std-numref">14.2.1절</span></a>에서처럼 실전 데이터를 다룰 때에는 일반적으로
확률값을 보정해줄 필요가 있다.</p>
<p>특히 데이터셋의 크기가 작을 수록 그렇다.
위 이항분포의 경우에서 시행횟수가 12, 40이 아니라 몇 백 이상으로 키우면
연속성 보정이 굳이 필요없을 정도로 오차가 크지 않다.
<a class="reference internal" href="probability_continuous.html#sec-continuity-correction"><span class="std std-numref">14.2.1절</span></a>의 경우도 데이터셋이 보다 커지면
특정 값에서의 확률이 0이 아니더라도 확률값 계산에 미치는 영향이 매우 미미해서 무시될 수 있다.</p>
</div>
</section>
</section>
<section id="id11">
<h2><span class="section-number">16.5. </span>연습문제<a class="headerlink" href="#id11" title="Link to this heading">#</a></h2>
<p>참고: <a class="reference external" href="https://colab.research.google.com/github/codingalzi/statsRev/blob/master/practices/practice-normal_distribution.ipynb">(연습) 정규분포</a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="expected_values.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">15. </span>기댓값과 분산</p>
      </div>
    </a>
    <a class="right-next"
       href="sampling_distribution.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">17. </span>표본분포</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">16.1. 가우스 함수</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">16.1.1. 표준정규분포</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">16.1.2. 정규분포 확률</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">16.1.3. 예제: 피어슨  데이터셋</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">16.2. 정규분포 선형 변환</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">16.3. 정규분포 특징</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">16.4. 정규분포 활용</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">16.4.1. 이항분포확률 계산</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">16.4.2. 연속성 보정</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">16.5. 연습문제</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By 코딩알지와 친구들
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>